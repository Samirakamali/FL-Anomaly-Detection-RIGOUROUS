Privacy-Preserving Federated Learning Anomaly Detection System

This repository contains a Privacy-Preserving Federated Learning (FL) Anomaly Detection System developed within the RIGOUROUS Project (Grant Agreement No. 101095933, Horizon Europe). The system demonstrates privacy-aware federated learning across distributed IoT/IIoT devices using Flask-based microservices.

--------------------------------------------------------
Key System Features 
--------------------------------------------------------

1. Two-client Federated Learning architecture

2. Flask-based microservice communication

3. Kafka-based real-time streaming for STIX message generation

4. Configurable FL training parameters

5. Supports Plain FL and Paillier Homomorphic Encryption modes

6. Optional integration with Encryption-as-a-Service (EaaS)

7. Designed for IIoT anomaly detection

8. Built using WUSTL-IIoT and DDoS-Sandbox datasets

--------------------------------------------------------
System Components
--------------------------------------------------------

Client0 and Client1
Simulated IoT devices performing local training in parallel.

Aggregator Server
Orchestrates FL rounds, aggregates model updates, and returns the global model.

Optional EaaS Integration
Allows clients to offload heavy Paillier homomorphic encryption to a remote encryption service.
Only the request-handling logic is included; encryption calls are commented out.
(Idea provided by ICT-FI partner.)

Kafka Integration
Sends STIX anomaly alerts to the decision engine.
(Kafka files components provided by ONE partner.)

Operational Modes
1. Plain Mode

Standard federated learning without encryption.
Enable by selecting plain in option.py (clients + server).

2. Paillier Homomorphic Encryption Mode

Secure FL mode using Paillier encryption for model exchange.
Enable by selecting paillier in option.py (clients + server)

--------------------------------------------------------
Datasets
--------------------------------------------------------

The system uses the following datasets:

WUSTL-IIoT (load_dataset.py)

DDoS-Sandbox (load_dataset2.py)

-------------------------------------------------------
System Architecture
-------------------------------------------------------

Client VM

Device 0 → Client0

Device 1 → Client1

Server VM

Runs the Aggregator Server

Coordinates FL rounds

-------------------------------------------------------------------
Execution Workflow
-------------------------------------------------------------------

1. Running the FL Clients

Open multiple terminal tabs in the Client VM:

Tab 1 – Device 0

```bash
cd /home/ubuntu/API_integration_device/Client0
python3 flask_device0.py
```

Tab 2 – Device 1

```bash
cd /home/ubuntu/API_integration_device/Client1
python3 flask_device1.py
```

Tab 3 – Kafka Subscriber (for Client0 or Client1)

```bash
cd /home/ubuntu/API_integration_device/Client0
python3 kafka-subscribing.py
```
Tab 4 (Optinal) – connecting to EaaS using VPN (if needed)

---

2. Running the Aggregator Server

On the Server VM:

Tab 1 – Start the Aggregator API

```bash
cd /home/ubuntu/EaaS/API_integration_server/Aggregator_server
python3 flask_server.py
```

Tab 2 – Trigger the Federated Learning Process

```bash
curl -X POST "http://0.0.0.0:8803/start_federated" \
     -H "Content-Type: application/json" \
     -d '{"num_iterations":10,"local_epoch":10,"classification_type":"mult"}'
```

This command initiates the federated learning process with the following parameters:

* `num_iterations`: Number of FL rounds
* `local_epoch`: Number of local training epochs per client
* `classification_type`: Model classification mode

-------------------------------------------------------------------
Citation
-------------------------------------------------------------------

If this asset is used in academic or industrial work, please cite the following publications:

1. **S. K. Poorazad, C. Benzaïd, T. Taleb**,
   "Blockchain and Deep Learning-Based IDS for Securing SDN-Enabled Industrial IoT Environments",
   *IEEE Global Communications Conference (GLOBECOM 2023)*, Kuala Lumpur, Malaysia, pp. 2760–2765, 2023.
   DOI: 10.1109/GLOBECOM54140.2023.10436839

2. **S. K. Poorazad, C. Benzaïd, T. Taleb**,
   "A Novel Buffered Federated Learning Framework for Privacy-Driven Anomaly Detection in IIoT",
   *IEEE Global Communications Conference (GLOBECOM 2024)*, Cape Town, South Africa, pp. 1725–1730, 2024.
   DOI: 10.1109/GLOBECOM52923.2024.10901786

Please include appropriate citation when reusing or building upon this framework or its associated assets.

----------------------------------------------------------------------
Notes
----------------------------------------------------------------------

* Ensure all Python dependencies are installed on each VM before execution.
* Kafka broker and EaaS endpoints must be accessible when corresponding features are enabled.
* This system is intended for research and demonstration purposes.

----------------------------------------------------------------------

© 2025 RIGOUROUS Project – University of Oulu
